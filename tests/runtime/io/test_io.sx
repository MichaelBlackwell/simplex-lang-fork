// test_io.sx - Test I/O operations

fn main() {
    println("=== I/O Operations Test ===");
    println("");

    // Test stderr
    println("--- Testing stderr ---");
    stderr_write("Writing to stderr: ");
    stderr_writeln("Hello stderr!");

    // Test file operations
    println("");
    println("--- Testing file operations ---");

    // Create a test file
    let test_path: str = "/tmp/simplex_io_test.txt";
    let content: str = "Hello from Simplex I/O test!";
    file_write(test_path, content);
    println("Wrote test file");

    // Check file exists
    let exists: bool = file_exists(test_path);
    if exists {
        println("File exists: OK");
    } else {
        println("File exists: FAIL");
    }

    // Check is_file
    let is_f: bool = is_file(test_path);
    if is_f {
        println("is_file: OK");
    } else {
        println("is_file: FAIL");
    }

    // Test file copy
    let copy_path: str = "/tmp/simplex_io_test_copy.txt";
    let copy_result: i64 = file_copy(test_path, copy_path);
    if copy_result == 0 {
        println("file_copy: OK");
    } else {
        println("file_copy: FAIL");
    }

    // Verify copy exists
    let copy_exists: bool = file_exists(copy_path);
    if copy_exists {
        println("Copy exists: OK");
    } else {
        println("Copy exists: FAIL");
    }

    // Test file rename
    let renamed_path: str = "/tmp/simplex_io_test_renamed.txt";
    let rename_result: i64 = file_rename(copy_path, renamed_path);
    if rename_result == 0 {
        println("file_rename: OK");
    } else {
        println("file_rename: FAIL");
    }

    // Verify renamed file exists and original doesn't
    let renamed_exists: bool = file_exists(renamed_path);
    let old_gone: bool = file_exists(copy_path);
    if renamed_exists {
        println("Renamed file exists: OK");
    } else {
        println("Renamed file exists: FAIL");
    }
    if old_gone {
        println("Old file still exists: FAIL");
    } else {
        println("Old file removed: OK");
    }

    // Clean up
    remove_path(test_path);
    remove_path(renamed_path);

    println("");
    println("=== I/O Test Complete ===");
}
