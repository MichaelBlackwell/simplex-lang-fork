// Test file for HashSet concepts
// Self-contained version - simulates set operations
//
// NOTE: Uses simple membership simulation

// =============================================================================
// Test 1: HashSet Creation
// =============================================================================

fn test_hashset_create() -> i64 {
    println("  Testing hashset creation...");

    // New hashset has 0 elements
    let len: i64 = 0;

    if len != 0 {
        println("    FAIL: new hashset should be empty");
        return 1;
    }

    let is_empty: i64 = if len == 0 { 1 } else { 0 };
    if is_empty != 1 {
        println("    FAIL: is_empty should be true");
        return 1;
    }

    println("    PASS: hashset creation");
    0
}

// =============================================================================
// Test 2: HashSet Insert and Contains
// =============================================================================

fn test_hashset_insert_contains() -> i64 {
    println("  Testing hashset insert/contains...");

    // Simulate inserting 3 elements
    let has_apple: i64 = 1;
    let has_banana: i64 = 1;
    let has_cherry: i64 = 1;
    let has_date: i64 = 0;
    let len: i64 = 3;

    if len != 3 {
        println("    FAIL: should have 3 elements");
        return 1;
    }

    if has_apple != 1 {
        println("    FAIL: should contain apple");
        return 1;
    }

    if has_date != 0 {
        println("    FAIL: should not contain date");
        return 1;
    }

    println("    PASS: hashset insert/contains");
    0
}

// =============================================================================
// Test 3: HashSet Remove
// =============================================================================

fn test_hashset_remove() -> i64 {
    println("  Testing hashset remove...");

    // Start with 3 elements
    let len_before: i64 = 3;

    // After remove
    let len_after: i64 = 2;
    let removed: i64 = 1;  // true

    if removed != 1 {
        println("    FAIL: remove should return true");
        return 1;
    }

    if len_after != 2 {
        println("    FAIL: length should be 2 after remove");
        return 1;
    }

    // Remove non-existent
    let remove_missing: i64 = 0;  // false
    if remove_missing != 0 {
        println("    FAIL: remove missing should return false");
        return 1;
    }

    println("    PASS: hashset remove");
    0
}

// =============================================================================
// Test 4: HashSet Duplicates
// =============================================================================

fn test_hashset_duplicates() -> i64 {
    println("  Testing hashset duplicates...");

    // Insert same element 3 times
    // Set should only have 1 element
    let len: i64 = 1;

    if len != 1 {
        println("    FAIL: duplicates should not increase size");
        return 1;
    }

    println("    PASS: hashset duplicates");
    0
}

// =============================================================================
// Test 5: HashSet Clear
// =============================================================================

fn test_hashset_clear() -> i64 {
    println("  Testing hashset clear...");

    let len_before: i64 = 5;
    let len_after: i64 = 0;

    if len_after != 0 {
        println("    FAIL: should be empty after clear");
        return 1;
    }

    println("    PASS: hashset clear");
    0
}

// =============================================================================
// Test 6: HashSet Union
// =============================================================================

fn test_hashset_union() -> i64 {
    println("  Testing hashset union...");

    // Set A: {1, 2, 3}
    // Set B: {3, 4, 5}
    // Union: {1, 2, 3, 4, 5}

    let union_len: i64 = 5;

    if union_len != 5 {
        println("    FAIL: union should have 5 elements");
        return 1;
    }

    // Check all elements present
    let has_1: i64 = 1;
    let has_5: i64 = 1;

    if has_1 != 1 {
        println("    FAIL: union should contain 1");
        return 1;
    }
    if has_5 != 1 {
        println("    FAIL: union should contain 5");
        return 1;
    }

    println("    PASS: hashset union");
    0
}

// =============================================================================
// Test 7: HashSet Intersection
// =============================================================================

fn test_hashset_intersection() -> i64 {
    println("  Testing hashset intersection...");

    // Set A: {1, 2, 3}
    // Set B: {2, 3, 4}
    // Intersection: {2, 3}

    let inter_len: i64 = 2;

    if inter_len != 2 {
        println("    FAIL: intersection should have 2 elements");
        return 1;
    }

    let has_2: i64 = 1;
    let has_1: i64 = 0;  // 1 is not in intersection

    if has_2 != 1 {
        println("    FAIL: intersection should contain 2");
        return 1;
    }
    if has_1 != 0 {
        println("    FAIL: intersection should not contain 1");
        return 1;
    }

    println("    PASS: hashset intersection");
    0
}

// =============================================================================
// Test 8: HashSet Difference
// =============================================================================

fn test_hashset_difference() -> i64 {
    println("  Testing hashset difference...");

    // Set A: {1, 2, 3}
    // Set B: {2, 4}
    // A - B: {1, 3}

    let diff_len: i64 = 2;

    if diff_len != 2 {
        println("    FAIL: difference should have 2 elements");
        return 1;
    }

    let has_1: i64 = 1;
    let has_2: i64 = 0;  // 2 is in B, so removed

    if has_1 != 1 {
        println("    FAIL: difference should contain 1");
        return 1;
    }
    if has_2 != 0 {
        println("    FAIL: difference should not contain 2");
        return 1;
    }

    println("    PASS: hashset difference");
    0
}

// =============================================================================
// Test 9: HashSet Subset
// =============================================================================

fn test_hashset_subset() -> i64 {
    println("  Testing hashset subset...");

    // A: {1, 2}
    // B: {1, 2, 3}
    // A is subset of B

    let a_subset_b: i64 = 1;  // true
    let b_subset_a: i64 = 0;  // false

    if a_subset_b != 1 {
        println("    FAIL: {1,2} should be subset of {1,2,3}");
        return 1;
    }

    if b_subset_a != 0 {
        println("    FAIL: {1,2,3} should not be subset of {1,2}");
        return 1;
    }

    println("    PASS: hashset subset");
    0
}

// =============================================================================
// Test 10: HashSet Symmetric Difference
// =============================================================================

fn test_hashset_symmetric_diff() -> i64 {
    println("  Testing hashset symmetric difference...");

    // A: {1, 2, 3}
    // B: {2, 3, 4}
    // Symmetric diff: {1, 4}

    let sym_diff_len: i64 = 2;

    if sym_diff_len != 2 {
        println("    FAIL: symmetric diff should have 2 elements");
        return 1;
    }

    let has_1: i64 = 1;
    let has_4: i64 = 1;
    let has_2: i64 = 0;  // 2 is in both, excluded

    if has_1 != 1 {
        println("    FAIL: sym diff should contain 1");
        return 1;
    }
    if has_4 != 1 {
        println("    FAIL: sym diff should contain 4");
        return 1;
    }
    if has_2 != 0 {
        println("    FAIL: sym diff should not contain 2");
        return 1;
    }

    println("    PASS: hashset symmetric difference");
    0
}

// =============================================================================
// Main Test Runner
// =============================================================================

fn main() -> i64 {
    println("=== HashSet Tests ===");
    println("");

    let f1: i64 = test_hashset_create();
    let f2: i64 = test_hashset_insert_contains();
    let f3: i64 = test_hashset_remove();
    let f4: i64 = test_hashset_duplicates();
    let f5: i64 = test_hashset_clear();
    let f6: i64 = test_hashset_union();
    let f7: i64 = test_hashset_intersection();
    let f8: i64 = test_hashset_difference();
    let f9: i64 = test_hashset_subset();
    let f10: i64 = test_hashset_symmetric_diff();

    let failures: i64 = f1 + f2 + f3 + f4 + f5 + f6 + f7 + f8 + f9 + f10;

    println("");
    if failures == 0 {
        println("All HashSet tests passed!");
    } else {
        println("Some HashSet tests failed");
    }

    failures
}
