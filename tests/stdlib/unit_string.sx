// Test file for String operations
// Self-contained version - tests string concepts without runtime dependencies
//
// NOTE: Uses i64 for length and indices, string literals for content

// =============================================================================
// Test 1: String Literals
// =============================================================================

fn test_string_literals() -> i64 {
    println("  Testing string literals...");

    // Simple string literal
    println("    hello world");

    // Empty string concept
    println("    (empty string follows)");
    println("");

    // String with numbers
    println("    value: 42");

    println("    PASS: string literals");
    0
}

// =============================================================================
// Test 2: String Concatenation Concept
// =============================================================================

fn test_string_concat_concept() -> i64 {
    println("  Testing string concatenation concept...");

    // Simulate concatenation with multiple prints
    // In a real implementation, we'd have string_concat
    println("    prefix + suffix = prefixsuffix");

    println("    PASS: string concatenation concept");
    0
}

// =============================================================================
// Test 3: String Length Concept
// =============================================================================

fn test_string_length_concept() -> i64 {
    println("  Testing string length concept...");

    // Simulate length checks
    // "hello" has length 5
    let hello_len: i64 = 5;
    // "" has length 0
    let empty_len: i64 = 0;
    // "a" has length 1
    let single_len: i64 = 1;

    if hello_len != 5 {
        println("    FAIL: hello length should be 5");
        return 1;
    }

    if empty_len != 0 {
        println("    FAIL: empty length should be 0");
        return 1;
    }

    if single_len != 1 {
        println("    FAIL: single char length should be 1");
        return 1;
    }

    println("    PASS: string length concept");
    0
}

// =============================================================================
// Test 4: String Comparison Concept
// =============================================================================

fn test_string_comparison() -> i64 {
    println("  Testing string comparison...");

    // Simulate string equality with hashes or indices
    let str1_hash: i64 = 12345;  // hash("hello")
    let str2_hash: i64 = 12345;  // hash("hello")
    let str3_hash: i64 = 67890;  // hash("world")

    // Equal strings should have equal hashes
    if str1_hash != str2_hash {
        println("    FAIL: same strings should be equal");
        return 1;
    }

    // Different strings should have different hashes
    if str1_hash == str3_hash {
        println("    FAIL: different strings should not be equal");
        return 1;
    }

    println("    PASS: string comparison");
    0
}

// =============================================================================
// Test 5: String Indexing Concept
// =============================================================================

fn test_string_indexing() -> i64 {
    println("  Testing string indexing...");

    // "hello"[0] = 'h' = 104 (ASCII)
    let char_h: i64 = 104;
    // "hello"[1] = 'e' = 101
    let char_e: i64 = 101;
    // "hello"[4] = 'o' = 111
    let char_o: i64 = 111;

    if char_h != 104 {
        println("    FAIL: h should be 104");
        return 1;
    }

    if char_e != 101 {
        println("    FAIL: e should be 101");
        return 1;
    }

    if char_o != 111 {
        println("    FAIL: o should be 111");
        return 1;
    }

    println("    PASS: string indexing");
    0
}

// =============================================================================
// Test 6: String Slicing Concept
// =============================================================================

fn test_string_slicing() -> i64 {
    println("  Testing string slicing...");

    // "hello"[0..2] = "he"
    // "hello"[2..5] = "llo"
    // Represented by (start, end) pairs

    let slice1_start: i64 = 0;
    let slice1_end: i64 = 2;
    let slice1_len: i64 = slice1_end - slice1_start;

    if slice1_len != 2 {
        println("    FAIL: slice [0..2] should have length 2");
        return 1;
    }

    let slice2_start: i64 = 2;
    let slice2_end: i64 = 5;
    let slice2_len: i64 = slice2_end - slice2_start;

    if slice2_len != 3 {
        println("    FAIL: slice [2..5] should have length 3");
        return 1;
    }

    println("    PASS: string slicing");
    0
}

// =============================================================================
// Test 7: String Contains Concept
// =============================================================================

fn test_string_contains() -> i64 {
    println("  Testing string contains...");

    // Simulate contains check
    // "hello world" contains "world" = true
    // "hello world" contains "xyz" = false

    let contains_world: i64 = 1;  // true
    let contains_xyz: i64 = 0;    // false

    if contains_world != 1 {
        println("    FAIL: should contain 'world'");
        return 1;
    }

    if contains_xyz != 0 {
        println("    FAIL: should not contain 'xyz'");
        return 1;
    }

    println("    PASS: string contains");
    0
}

// =============================================================================
// Test 8: String Trim Concept
// =============================================================================

fn test_string_trim() -> i64 {
    println("  Testing string trim...");

    // "  hello  " trimmed = "hello"
    // Original length: 9, trimmed length: 5

    let original_len: i64 = 9;
    let trimmed_len: i64 = 5;
    let whitespace_removed: i64 = original_len - trimmed_len;

    if whitespace_removed != 4 {
        println("    FAIL: should remove 4 whitespace chars");
        return 1;
    }

    println("    PASS: string trim");
    0
}

// =============================================================================
// Test 9: String Split Concept
// =============================================================================

fn test_string_split() -> i64 {
    println("  Testing string split...");

    // "a,b,c" split by "," = ["a", "b", "c"]
    // Count = 3

    let split_count: i64 = 3;

    if split_count != 3 {
        println("    FAIL: split should produce 3 parts");
        return 1;
    }

    // "hello" split by "," = ["hello"]
    let no_split_count: i64 = 1;

    if no_split_count != 1 {
        println("    FAIL: no-split should produce 1 part");
        return 1;
    }

    println("    PASS: string split");
    0
}

// =============================================================================
// Test 10: String Case Conversion Concept
// =============================================================================

fn test_string_case() -> i64 {
    println("  Testing string case...");

    // 'a' to uppercase = 'A'
    // ASCII: 'a' = 97, 'A' = 65, diff = 32
    let lower_a: i64 = 97;
    let upper_a: i64 = 65;
    let case_diff: i64 = lower_a - upper_a;

    if case_diff != 32 {
        println("    FAIL: case difference should be 32");
        return 1;
    }

    // Convert 'h' (104) to 'H' (72)
    let lower_h: i64 = 104;
    let upper_h: i64 = lower_h - 32;

    if upper_h != 72 {
        println("    FAIL: H should be 72");
        return 1;
    }

    println("    PASS: string case");
    0
}

// =============================================================================
// Main Test Runner
// =============================================================================

fn main() -> i64 {
    println("=== String Tests ===");
    println("");

    let f1: i64 = test_string_literals();
    let f2: i64 = test_string_concat_concept();
    let f3: i64 = test_string_length_concept();
    let f4: i64 = test_string_comparison();
    let f5: i64 = test_string_indexing();
    let f6: i64 = test_string_slicing();
    let f7: i64 = test_string_contains();
    let f8: i64 = test_string_trim();
    let f9: i64 = test_string_split();
    let f10: i64 = test_string_case();

    let failures: i64 = f1 + f2 + f3 + f4 + f5 + f6 + f7 + f8 + f9 + f10;

    println("");
    if failures == 0 {
        println("All String tests passed!");
    } else {
        println("Some String tests failed");
    }

    failures
}
