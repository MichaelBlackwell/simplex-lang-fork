// Neural gate test - hardware annotations

@cpu
neural_gate cpu_gate(x: f64) -> bool {
    x > 0.5
}

fn main() -> i64 {
    println("Test: Neural gate with @cpu annotation");

    neural_set_training_mode(0);

    let r: f64 = cpu_gate(0.8);
    println("Called cpu_gate");

    if r > 0.5 {
        println("TEST PASSED");
        return 0;
    }

    println("TEST FAILED");
    1
}
