// Test: &self in trait methods

trait Describable {
 fn describe(&self) -> i64;
 fn get_value(&self) -> i64;
}

struct Point {
 x: i64,
 y: i64
}

impl Describable for Point {
 fn describe(&self) -> i64 {
 self.x + self.y
 }

 fn get_value(&self) -> i64 {
 self.x * self.y
 }
}

trait Mutable {
 fn increment(&mut self) -> i64;
}

struct Counter {
 value: i64
}

impl Mutable for Counter {
 fn increment(&mut self) -> i64 {
 self.value = self.value + 1;
 self.value
 }
}

fn main() -> i64 {
 print("Testing &self in trait methods");

 let p = Point { x: 10, y: 20 };
 let sum: i64 = p.describe();
 if sum != 30 {
 print("FAIL: describe() returned wrong value");
 return 1;
 }
 print(" PASS: &self method call");

 let product: i64 = p.get_value();
 if product != 200 {
 print("FAIL: get_value() returned wrong value");
 return 1;
 }
 print(" PASS: second &self method");

 print("Testing &mut self");
 let c = Counter { value: 0 };
 let v1: i64 = c.increment();
 if v1 != 1 {
 print("FAIL: increment returned wrong value");
 return 1;
 }
 print(" PASS: &mut self method");

 print("All tests passed!");
 0
}
