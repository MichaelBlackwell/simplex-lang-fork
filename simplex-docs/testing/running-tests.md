# Running Simplex Tests

**Version:** 0.5.0

## Quick Start

### Run All Tests

```bash
sxpm test
```

### Expected Output

```
==============================================
         Simplex Language Test Suite
==============================================

Language
  basics
    test_loops                                  PASS
    test_closures                               PASS
    test_enums                                  PASS
    ...

Standard Library
  test_hashmap                                  PASS
  test_strings                                  PASS
  ...

Runtime
  ...

AI / Cognitive
  anima
    test_anima_hive_integration                 PASS
  hive
    test_hive_mnemonic                          PASS
    test_per_hive_slm                           PASS
  ...

Integration
  test_multi_specialist_reasoning               PASS
  test_knowledge_persistence                    PASS
  ...

==============================================
  Passed:  103
  Failed:  0
  Total:   103 (100% pass rate)
==============================================
```

## Running Individual Tests

### Using sxc (Compiler)

```bash
# Compile and run a single test
sxc run tests/language/basics/test_loops.sx

# Compile only (produces .sxb bytecode)
sxc compile tests/language/basics/test_loops.sx

# Check syntax without running
sxc check tests/language/basics/test_loops.sx
```

### Using sxpm (Package Manager)

```bash
# Run a specific test file
sxpm test tests/stdlib/test_hashmap.sx

# Run tests matching a pattern
sxpm test --filter "test_hive*"
```

### Using spx (Runner)

```bash
# Run compiled bytecode directly
spx tests/language/basics/test_loops.sxb
```

## Running Tests by Category

```bash
# Language tests only
sxpm test --category language

# Standard library tests
sxpm test --category stdlib

# AI/Cognitive tests
sxpm test --category ai

# Integration tests
sxpm test --category integration

# Multiple categories
sxpm test --category language --category stdlib
```

## Verbose Output

To see detailed test output:

```bash
# Full verbose output
sxpm test --verbose

# Verbose for specific test
sxc run tests/stdlib/test_hashmap.sx
```

Example verbose output:
```
=== HashMap Test ===

--- Test 1: Create HashMap ---
PASS: HashMap created

--- Test 2: Insert and Get ---
PASS: Value retrieved correctly

--- Test 3: Contains Key ---
PASS: Contains key works

=== HashMap Test Complete! ===
```

## Test Filtering

```bash
# Run tests matching pattern
sxpm test --filter "hashmap"

# Run tests in specific subdirectory
sxpm test tests/ai/hive/

# Exclude tests matching pattern
sxpm test --exclude "slow_*"
```

## Debugging Failed Tests

### Step 1: Run with Verbose Output

```bash
sxc run tests/failing_test.sx
```

### Step 2: Check Compilation

```bash
# Syntax check only
sxc check tests/failing_test.sx

# Compile with debug info
sxc compile --debug tests/failing_test.sx
```

### Step 3: Inspect Compiled Output

```bash
# Generate readable IR
sxc compile --emit-ir tests/failing_test.sx

# View generated bytecode
sxc compile --emit-asm tests/failing_test.sx
```

## Test Result Interpretation

### Color Codes

| Color | Meaning |
|-------|---------|
| CYAN | Category/subcategory name |
| GREEN | Test passed |
| RED | Test failed |
| YELLOW | Top-level category |

### Failure Types

| Result | Cause |
|--------|-------|
| `COMPILE FAIL` | Syntax error or type error in test |
| `RUNTIME FAIL` | Runtime exception or panic |
| `FAIL` | Test assertions failed (exit code non-zero) |
| `TIMEOUT` | Test exceeded time limit |

## Continuous Integration

### CI Configuration

```yaml
# .simplex-ci.yml
name: Simplex Tests

stages:
  - test

test:
  script:
    - sxpm test
  artifacts:
    reports:
      - test-results.xml
```

### Exit Codes for CI

The test runner returns:
- `0` if all tests pass
- `1` if any test fails

## Watch Mode

Run tests automatically on file changes:

```bash
# Watch all tests
sxpm test --watch

# Watch specific category
sxpm test --watch --category ai
```

## Parallel Execution

Run tests in parallel for faster execution:

```bash
# Run with 4 parallel workers
sxpm test --parallel 4

# Auto-detect CPU cores
sxpm test --parallel auto
```

## Test Coverage

Generate coverage reports:

```bash
# Run with coverage
sxpm test --coverage

# Generate HTML report
sxpm test --coverage --format html

# Coverage for specific category
sxpm test --coverage --category ai
```

## Test Timeouts

Configure test timeouts:

```bash
# Set global timeout (seconds)
sxpm test --timeout 120

# No timeout
sxpm test --timeout 0
```

## Troubleshooting

### "Test not found"

```bash
# Verify test file exists
ls tests/path/to/test.sx

# Check test pattern
sxpm test --list  # Lists all discovered tests
```

### "Compilation failed"

```bash
# Get detailed error
sxc check tests/failing_test.sx

# Check for missing imports
sxc compile --verbose tests/failing_test.sx
```

### "Test hangs"

If a test appears to hang:
1. Check for infinite loops in test code
2. Check for blocking I/O without timeout
3. Use `--timeout` flag to force termination

```bash
sxpm test tests/hanging_test.sx --timeout 10
```

### "Inconsistent results"

If tests pass sometimes and fail others:
1. Check for uninitialized variables
2. Check for race conditions in async tests
3. Run with `--no-parallel` to isolate issues

```bash
sxpm test --no-parallel --verbose
```
