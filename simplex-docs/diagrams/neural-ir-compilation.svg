<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 580" width="800" height="580">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <linearGradient id="sourceGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b35"/>
      <stop offset="100%" style="stop-color:#cc5500"/>
    </linearGradient>
    <linearGradient id="nirGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#00d9ff"/>
      <stop offset="100%" style="stop-color:#0077b6"/>
    </linearGradient>
    <linearGradient id="trainGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9d4edd"/>
      <stop offset="100%" style="stop-color:#7b2cbf"/>
    </linearGradient>
    <linearGradient id="inferGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#00ff88"/>
      <stop offset="100%" style="stop-color:#00b359"/>
    </linearGradient>
    <linearGradient id="tempScale" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9d4edd"/>
      <stop offset="50%" style="stop-color:#00d9ff"/>
      <stop offset="100%" style="stop-color:#00ff88"/>
    </linearGradient>
    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8892b0"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="580" fill="url(#bgGradient)"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="20" font-weight="bold">Neural IR: From Probabilistic to Symbolic</text>
  <text x="400" y="50" text-anchor="middle" fill="#8892b0" font-family="Arial, sans-serif" font-size="12">Differentiable â†’ Discrete Compilation Pipeline</text>

  <!-- Source Code -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="200" height="140" rx="8" fill="url(#sourceGradient)" filter="url(#glow)"/>
    <text x="100" y="25" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Simplex Source</text>

    <rect x="15" y="40" width="170" height="85" rx="4" fill="#1a1a2e" opacity="0.6"/>
    <text x="25" y="58" fill="#00d9ff" font-family="monospace" font-size="9">neural_gate classify(x)</text>
    <text x="25" y="72" fill="#00d9ff" font-family="monospace" font-size="9">  @confidence(0.9)</text>
    <text x="25" y="86" fill="#00d9ff" font-family="monospace" font-size="9">{</text>
    <text x="25" y="100" fill="#00d9ff" font-family="monospace" font-size="9">  x &gt; threshold</text>
    <text x="25" y="114" fill="#00d9ff" font-family="monospace" font-size="9">}</text>
  </g>

  <!-- Arrow -->
  <line x1="255" y1="150" x2="295" y2="150" stroke="#8892b0" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Neural IR -->
  <g transform="translate(300, 80)">
    <rect x="0" y="0" width="200" height="140" rx="8" fill="url(#nirGradient)" filter="url(#glow)"/>
    <text x="100" y="25" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Neural IR</text>

    <rect x="15" y="40" width="170" height="85" rx="4" fill="#1a1a2e" opacity="0.6"/>
    <text x="25" y="58" fill="#ffffff" font-family="Arial, sans-serif" font-size="9" font-weight="bold">gate_node:</text>
    <text x="35" y="72" fill="#cceeff" font-family="monospace" font-size="8">input: x</text>
    <text x="35" y="84" fill="#cceeff" font-family="monospace" font-size="8">threshold: learnable</text>
    <text x="35" y="96" fill="#cceeff" font-family="monospace" font-size="8">temperature: &#964;</text>
    <text x="35" y="108" fill="#cceeff" font-family="monospace" font-size="8">activation: gumbel_softmax</text>
    <text x="35" y="120" fill="#cceeff" font-family="monospace" font-size="8">confidence: 0.9</text>
  </g>

  <!-- Split arrows -->
  <line x1="505" y1="120" x2="545" y2="80" stroke="#9d4edd" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="505" y1="180" x2="545" y2="220" stroke="#00ff88" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Training Mode -->
  <g transform="translate(550, 40)">
    <rect x="0" y="0" width="200" height="120" rx="8" fill="url(#trainGradient)" filter="url(#glow)"/>
    <text x="100" y="22" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Training Mode</text>
    <text x="100" y="38" text-anchor="middle" fill="#e0c3fc" font-family="Arial, sans-serif" font-size="10">(High Temperature)</text>

    <rect x="15" y="50" width="170" height="60" rx="4" fill="#1a1a2e" opacity="0.5"/>
    <text x="100" y="68" text-anchor="middle" fill="#e0c3fc" font-family="Arial, sans-serif" font-size="9">Gumbel-Softmax</text>
    <text x="100" y="82" text-anchor="middle" fill="#e0c3fc" font-family="Arial, sans-serif" font-size="9">Gradient flow enabled</text>
    <text x="100" y="96" text-anchor="middle" fill="#e0c3fc" font-family="Arial, sans-serif" font-size="9">Soft probabilistic output</text>
  </g>

  <!-- Inference Mode -->
  <g transform="translate(550, 180)">
    <rect x="0" y="0" width="200" height="120" rx="8" fill="url(#inferGradient)" filter="url(#glow)"/>
    <text x="100" y="22" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Inference Mode</text>
    <text x="100" y="38" text-anchor="middle" fill="#ccffdd" font-family="Arial, sans-serif" font-size="10">(Low Temperature)</text>

    <rect x="15" y="50" width="170" height="60" rx="4" fill="#1a1a2e" opacity="0.5"/>
    <text x="100" y="68" text-anchor="middle" fill="#ccffdd" font-family="Arial, sans-serif" font-size="9">Compiled to branch</text>
    <text x="100" y="82" text-anchor="middle" fill="#ccffdd" font-family="Arial, sans-serif" font-size="9">Zero runtime overhead</text>
    <text x="100" y="96" text-anchor="middle" fill="#ccffdd" font-family="Arial, sans-serif" font-size="9">Hard discrete logic</text>
  </g>

  <!-- Temperature annealing visualization (shifted down) -->
  <g transform="translate(100, 330)">
    <rect x="0" y="0" width="600" height="120" rx="8" fill="#0f3460" opacity="0.5"/>
    <text x="300" y="25" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Self-Learning Annealing: &#964; Controls Gate Hardness</text>

    <!-- Temperature scale -->
    <rect x="50" y="50" width="500" height="30" rx="4" fill="none" stroke="#4a5568" stroke-width="1"/>
    <rect x="50" y="50" width="500" height="30" rx="4" fill="url(#tempScale)" opacity="0.7"/>

    <!-- Labels -->
    <text x="50" y="95" text-anchor="start" fill="#9d4edd" font-family="Arial, sans-serif" font-size="10">&#964; = 1.0</text>
    <text x="50" y="107" text-anchor="start" fill="#8892b0" font-family="Arial, sans-serif" font-size="9">Fuzzy (Train)</text>

    <text x="300" y="95" text-anchor="middle" fill="#00d9ff" font-family="Arial, sans-serif" font-size="10">&#964; = 0.5</text>
    <text x="300" y="107" text-anchor="middle" fill="#8892b0" font-family="Arial, sans-serif" font-size="9">Transition</text>

    <text x="550" y="95" text-anchor="end" fill="#00ff88" font-family="Arial, sans-serif" font-size="10">&#964; = 0.01</text>
    <text x="550" y="107" text-anchor="end" fill="#8892b0" font-family="Arial, sans-serif" font-size="9">Hard (Deploy)</text>
  </g>

  <!-- Meta-gradient box (shifted down) -->
  <g transform="translate(100, 470)">
    <rect x="0" y="0" width="280" height="80" rx="8" fill="#0f3460" opacity="0.7" stroke="#00d9ff" stroke-width="1"/>
    <text x="140" y="22" text-anchor="middle" fill="#00d9ff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Meta-Gradient Control</text>
    <text x="20" y="45" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8706;L/&#8706;&#964; &lt; 0 &#8594; Continue cooling</text>
    <text x="20" y="62" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8706;L/&#8706;&#964; &gt; 0 &#8594; Re-heat (escape minima)</text>
  </g>

  <!-- Output formats box (shifted down) -->
  <g transform="translate(420, 470)">
    <rect x="0" y="0" width="280" height="80" rx="8" fill="#0f3460" opacity="0.7" stroke="#00ff88" stroke-width="1"/>
    <text x="140" y="22" text-anchor="middle" fill="#00ff88" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Compilation Targets</text>
    <text x="20" y="45" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8226; Native binary (LLVM)</text>
    <text x="150" y="45" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8226; WebAssembly</text>
    <text x="20" y="62" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8226; GPU kernels</text>
    <text x="150" y="62" fill="#8892b0" font-family="Arial, sans-serif" font-size="10">&#8226; ONNX export</text>
  </g>

  <!-- Footer (shifted down) -->
  <text x="400" y="570" text-anchor="middle" fill="#4a5568" font-family="Arial, sans-serif" font-size="10">Neurosymbolic transition: Neural Network &#8594; Symbolic Program (automatic)</text>
</svg>
