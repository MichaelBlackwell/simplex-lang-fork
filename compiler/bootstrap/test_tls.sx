fn main() -> i64 {
    let passed = 0;
    let failed = 0;
    print("=== TLS Tests ===\n");

    // Test 1: Create client context
    print("Test 1: tls_context_new_client creates context... ");
    let client_ctx = tls_context_new_client();
    if client_ctx != 0 {
        print("PASSED\n");
        passed = passed + 1;
    } else {
        print("FAILED\n");
        failed = failed + 1;
    }

    // Test 2: Create server context
    print("Test 2: tls_context_new_server creates context... ");
    let server_ctx = tls_context_new_server();
    if server_ctx != 0 {
        print("PASSED\n");
        passed = passed + 1;
    } else {
        print("FAILED\n");
        failed = failed + 1;
    }

    // Test 3: Client and server contexts are different
    print("Test 3: Client and server contexts are distinct... ");
    if client_ctx != server_ctx {
        print("PASSED\n");
        passed = passed + 1;
    } else {
        print("FAILED\n");
        failed = failed + 1;
    }

    // Test 4: Set verify mode 0 (none) on client context
    print("Test 4: tls_context_set_verify with mode 0... ");
    tls_context_set_verify(client_ctx, 0);
    print("PASSED\n");
    passed = passed + 1;

    // Test 5: Set verify mode 1 (peer) on client context
    print("Test 5: tls_context_set_verify with mode 1... ");
    tls_context_set_verify(client_ctx, 1);
    print("PASSED\n");
    passed = passed + 1;

    // Test 6: Set verify mode on server context
    print("Test 6: tls_context_set_verify on server context... ");
    tls_context_set_verify(server_ctx, 0);
    print("PASSED\n");
    passed = passed + 1;

    // Test 7: Get error string returns valid pointer
    print("Test 7: tls_error_string returns value... ");
    let err_str = tls_error_string();
    // Error string should return a valid pointer (even if empty string)
    if err_str >= 0 {
        print("PASSED\n");
        passed = passed + 1;
    } else {
        print("FAILED\n");
        failed = failed + 1;
    }

    // Test 8: Free client context
    print("Test 8: tls_context_free on client context... ");
    tls_context_free(client_ctx);
    print("PASSED\n");
    passed = passed + 1;

    // Test 9: Free server context
    print("Test 9: tls_context_free on server context... ");
    tls_context_free(server_ctx);
    print("PASSED\n");
    passed = passed + 1;

    // Test 10: Create and free multiple contexts
    print("Test 10: Create and free multiple contexts... ");
    let ctx1 = tls_context_new_client();
    let ctx2 = tls_context_new_client();
    let ctx3 = tls_context_new_server();
    if ctx1 != 0 && ctx2 != 0 && ctx3 != 0 && ctx1 != ctx2 && ctx2 != ctx3 {
        tls_context_free(ctx1);
        tls_context_free(ctx2);
        tls_context_free(ctx3);
        print("PASSED\n");
        passed = passed + 1;
    } else {
        print("FAILED\n");
        failed = failed + 1;
    }

    print("Passed: "); print_i64(passed); print(" / "); print_i64(passed + failed); print("\n");
    return failed;
}
